(window["webpackJsonp"] = window["webpackJsonp"] || []).push([[18],{

/***/ "./src/components/header/header.js":
/*!*****************************************!*\
  !*** ./src/components/header/header.js ***!
  \*****************************************/
/*! exports provided: DOWN, ESCAPE, RETURN, TAB, UP, searchSuggestion, searchSuggestionDidYouMean, default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DOWN\", function() { return DOWN; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ESCAPE\", function() { return ESCAPE; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RETURN\", function() { return RETURN; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TAB\", function() { return TAB; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UP\", function() { return UP; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"searchSuggestion\", function() { return searchSuggestion; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"searchSuggestionDidYouMean\", function() { return searchSuggestionDidYouMean; });\n/* harmony import */ var _verndale_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @verndale/core */ \"./node_modules/@verndale/core/lib/index.js\");\n/* harmony import */ var _verndale_core__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_verndale_core__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var focus_trap__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! focus-trap */ \"./node_modules/focus-trap/dist/focus-trap.esm.js\");\n/* harmony import */ var body_scroll_lock__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! body-scroll-lock */ \"./node_modules/body-scroll-lock/lib/bodyScrollLock.esm.js\");\n/* harmony import */ var query_string__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! query-string */ \"./node_modules/query-string/index.js\");\n/* harmony import */ var query_string__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(query_string__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var number_to_text__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! number-to-text */ \"./node_modules/number-to-text/index.js\");\n/* harmony import */ var number_to_text__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(number_to_text__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var number_to_text_converters_en_us__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! number-to-text/converters/en-us */ \"./node_modules/number-to-text/converters/en-us.js\");\n/* harmony import */ var number_to_text_converters_en_us__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(number_to_text_converters_en_us__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\nconst DOWN = 40;\nconst ESCAPE = 27;\nconst RETURN = 13;\nconst TAB = 9;\nconst UP = 38;\nfunction searchSuggestion(_ref, index) {\n  let {\n    Label,\n    Tag,\n    Url\n  } = _ref;\n  return `\n    <li\n      aria-selected=\"false\"\n      aria-labelledby=\"search-suggested-results-heading\"\n      class=\"header__search-item\"\n      role=\"option\"\n      id=\"suggestion-${index}\"\n    >\n      <a href=\"${Url}\" tabindex=\"0\">\n        ${Label ? `<span>${Label}</span>` : ''}\n        ${Tag ? `<span>${Tag}</span>` : ''}\n      </a>\n    </li>\n  `;\n}\nfunction searchSuggestionDidYouMean(Label, Value, Url, index) {\n  return `\n      <li\n      aria-labelledby=\"search-suggested-results-heading\"\n      class=\"header__search-item--did-you-mean\"\n      role=\"option\"\n      id=\"suggestion-${index}\"\n    >\n      <a href=\"${Url}\" tabindex=\"0\">\n        ${Label ? `<span>${Label} ${Value}</span>` : ''}\n      </a>\n    </li>\n  `;\n}\n\nclass Header extends _verndale_core__WEBPACK_IMPORTED_MODULE_0__[\"Component\"] {\n  setupDefaults() {\n    const self = this;\n    this.dom = {\n      $btnNav: this.el.querySelector('.header__mobile-btn--nav'),\n      $mobileItemBtn: this.el.querySelectorAll('.header__mobile-item button'),\n      $mobileMenuItemBackBtn: this.el.querySelectorAll('.header__mobile-item--back button'),\n      $mobileInnerNav: this.el.querySelectorAll('.header__mobile-inner-nav'),\n      $search: this.el.querySelector('.header__search'),\n      $searchBtn: this.el.querySelector('.header__search-btn'),\n      $searchInput: this.el.querySelector('.header__search-input'),\n      $searchField: this.el.querySelector('.header__search-field'),\n      $clearInputBtn: this.el.querySelector('.header__clear-input-btn'),\n      $itemBtn: this.el.querySelectorAll('.header__item button'),\n      $itemlinks: this.el.querySelectorAll('.header__item a'),\n      $activePage: this.el.querySelector('.header__item--active'),\n      $resultsList: this.el.querySelector('.header__search-results ul'),\n      $viewAll: this.el.querySelector('.header__search-view-all'),\n      $searchAnnounce: this.el.querySelector('#search-announce'),\n      $headerContainer: this.el.querySelector('.header__content-wrapper'),\n      $headerItemNav: this.el.querySelectorAll('.header__inner-nav')\n    };\n    this.endpoint = this.dom.$search.dataset.endpoint;\n    this.searchPageUrl = this.dom.$search.dataset.searchPageUrl;\n    this.mainFocusTrap = Object(focus_trap__WEBPACK_IMPORTED_MODULE_1__[\"createFocusTrap\"])(this.el, {\n      onActivate() {\n        Object(body_scroll_lock__WEBPACK_IMPORTED_MODULE_2__[\"disableBodyScroll\"])(self.el, {\n          allowTouchMove: el => el.closest('.header__mobile-nav')\n        });\n      },\n\n      onDeactivate() {\n        Object(body_scroll_lock__WEBPACK_IMPORTED_MODULE_2__[\"clearAllBodyScrollLocks\"])();\n      }\n\n    });\n    this.searchInputWidth();\n    this.displaySubmenus();\n    this.lastScrollTop = 0;\n  }\n\n  addListeners() {\n    this.dom.$btnNav.addEventListener('click', () => this.handleBtnNavClick());\n    this.dom.$mobileItemBtn.forEach($btn => $btn.addEventListener('click', e => this.handleMobileItemBtnClick(e)));\n    this.dom.$mobileMenuItemBackBtn.forEach($btn => $btn.addEventListener('click', e => this.handleMenuItemBackBtnClick(e)));\n    this.dom.$mobileInnerNav.forEach($nav => $nav.addEventListener('transitionend', e => this.handleMobileInnerNavTransitionEnd(e)));\n    this.dom.$mobileInnerNav.forEach($nav => $nav.addEventListener('focusout', e => this.handleMobileInnerNavFocusout(e)));\n    this.dom.$itemBtn.forEach($btn => $btn.addEventListener('click', e => this.handleItemBtnClick(e)));\n    this.dom.$itemlinks.forEach($link => $link.addEventListener('click', e => this.handleItemActive(e)));\n    this.dom.$searchBtn.addEventListener('click', () => this.handleSearchBtnClick());\n    this.dom.$searchField.addEventListener('transitionend', e => this.handleSearchFieldTransitionEnd(e));\n    this.dom.$clearInputBtn.addEventListener('click', e => this.handleClearInputBtn(e));\n    this.dom.$search.addEventListener('focusout', e => this.handleSearchFocusout(e));\n    this.dom.$searchInput.addEventListener('keydown', e => this.handleSearchInputKeydown(e));\n    this.dom.$resultsList.addEventListener('keydown', e => this.handleResultsListKeydown(e));\n    this.dom.$searchInput.addEventListener('input', e => this.handleSearchInputChange(e));\n    this.dom.$searchInput.addEventListener('blur', e => this.handleSearchInputBlur(e));\n    this.el.addEventListener('focus', e => this.handleListFocus(e), true);\n    document.addEventListener('click', e => this.handleOutsideClick(e));\n    window.addEventListener('resize', this.handleResize.bind(this));\n    window.addEventListener('scroll', this.handleScroll.bind(this));\n  }\n\n  displaySubmenus() {\n    this.dom.$headerItemNav.forEach(item => item.removeAttribute('style'));\n  }\n\n  searchInputWidth() {\n    this.searchSvgDimensions = this.dom.$searchBtn.getBoundingClientRect();\n    this.headerDimensions = this.dom.$headerContainer.getBoundingClientRect();\n    this.searchWidth = this.headerDimensions.left + this.headerDimensions.width - this.searchSvgDimensions.left - 20;\n    this.el.style = `--search-width: ${this.searchWidth}px`;\n  }\n\n  handleBtnNavClick() {\n    const isExpanded = this.dom.$btnNav.getAttribute('aria-expanded') === 'true';\n    this.el.classList.toggle('header--expanded', !isExpanded);\n    this.dom.$btnNav.setAttribute('aria-expanded', !isExpanded);\n    this.closeSearchInput(false);\n\n    if (isExpanded) {\n      this.mainFocusTrap.deactivate();\n    } else {\n      this.mainFocusTrap.activate();\n    }\n  }\n\n  handleMobileItemBtnClick(e) {\n    e.currentTarget.setAttribute('aria-expanded', true);\n  }\n\n  handleItemActive(e) {\n    var _this$dom$$activePage;\n\n    (_this$dom$$activePage = this.dom.$activePage) === null || _this$dom$$activePage === void 0 ? void 0 : _this$dom$$activePage.classList.remove('header__item--active');\n    const clickedLink = e.currentTarget.closest('.header__item');\n    clickedLink.classList.add('header__item--active');\n    this.dom.$activePage = clickedLink;\n    const butHref = e.currentTarget.getAttribute('href');\n\n    if (butHref.indexOf('#')) {\n      if (window.location.pathname === butHref.substring(0, butHref.indexOf('#'))) {\n        this.dom.$itemBtn.forEach($btn => $btn.setAttribute('aria-expanded', false));\n      }\n    }\n  }\n\n  handleMenuItemBackBtnClick(e) {\n    const menu = e.currentTarget.closest('.header__mobile-inner-nav');\n    const triggerBtn = menu.previousElementSibling;\n    triggerBtn.setAttribute('aria-expanded', false);\n    triggerBtn.focus();\n  }\n\n  handleMobileInnerNavFocusout(e) {\n    if (!e.currentTarget.contains(e.relatedTarget)) {\n      const triggerBtn = e.currentTarget.previousElementSibling;\n      triggerBtn.setAttribute('aria-expanded', false);\n    }\n  }\n\n  handleSearchFocusout(e) {\n    if (!e.currentTarget.contains(e.relatedTarget) && e.relatedTarget) {\n      this.closeSearchInput(false);\n    }\n  }\n\n  handleItemBtnClick(e) {\n    e.stopImmediatePropagation();\n    const isExpanded = e.currentTarget.getAttribute('aria-expanded') === 'true';\n    Array.from(this.dom.$itemBtn).filter($btn => $btn !== e.currentTarget).forEach($btn => $btn.setAttribute('aria-expanded', false));\n    e.currentTarget.setAttribute('aria-expanded', !isExpanded);\n  }\n\n  handleOutsideClick(e) {\n    if (!e.target.closest('.header__search')) {\n      this.closeSearchInput(false);\n    }\n\n    if (!e.target.closest('.header__inner-nav')) {\n      this.dom.$itemBtn.forEach($btn => $btn.setAttribute('aria-expanded', false));\n    }\n  }\n\n  handleSearchBtnClick() {\n    this.el.classList.remove('header--expanded');\n    this.dom.$btnNav.setAttribute('aria-expanded', false);\n    this.dom.$searchField.classList.add('header__search-field--open');\n    this.dom.$searchBtn.setAttribute('tabindex', -1);\n  }\n\n  handleSearchFieldTransitionEnd(e) {\n    if (e.propertyName === 'visibility') {\n      this.dom.$searchInput.focus();\n    }\n  }\n\n  handleSearchInputKeydown(e) {\n    switch (e.keyCode) {\n      case ESCAPE:\n        this.closeSearchInput();\n        break;\n\n      case DOWN:\n        {\n          e.preventDefault();\n          const links = this.dom.$resultsList.querySelectorAll('a');\n\n          if (this.dom.$searchField.dataset.hasResults === 'true' && links) {\n            links[0].focus();\n          } else {\n            links[0].focus();\n          }\n        }\n        break;\n\n      case UP:\n        {\n          e.preventDefault();\n          const links = this.dom.$resultsList.querySelectorAll('a');\n\n          if (this.dom.$searchField.dataset.hasResults === 'true' && links) {\n            links[links.length - 1].focus();\n          }\n        }\n        break;\n\n      case RETURN:\n        this.dom.$viewAll.click();\n        break;\n\n      default:\n        break;\n    }\n  }\n\n  handleResultsListKeydown(e) {\n    if (this.dom.$searchField.dataset.hasResults === 'true') {\n      const links = Array.from(this.dom.$resultsList.querySelectorAll('a'));\n      const currentIndex = links.findIndex(link => link === document.activeElement);\n\n      switch (e.keyCode) {\n        case DOWN:\n          e.preventDefault();\n          links[(currentIndex + 1) % links.length].focus();\n          break;\n\n        case UP:\n          e.preventDefault();\n          links[(currentIndex - 1 + links.length) % links.length].focus();\n          break;\n\n        case TAB:\n          {\n            e.preventDefault();\n\n            if (e.shiftKey) {\n              this.dom.$searchInput.focus();\n            } else {\n              this.dom.$viewAll.focus();\n            }\n          }\n\n        default:\n          break;\n      }\n    }\n  }\n\n  handleSearchInputBlur(e) {\n    if (!e.target.value) {\n      this.closeSearchInput(false);\n    }\n  }\n\n  closeSearchInput() {\n    let focusBtn = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    this.dom.$searchBtn.removeAttribute('tabindex');\n    this.dom.$searchField.classList.remove('header__search-field--open');\n    this.dom.$searchField.setAttribute('aria-expanded', false);\n\n    if (focusBtn) {\n      this.dom.$searchBtn.focus();\n    }\n  }\n\n  handleMobileInnerNavTransitionEnd(e) {\n    const backButton = e.currentTarget.querySelector('.header__mobile-item--back button');\n\n    if (e.propertyName === 'visibility') {\n      backButton.focus();\n    }\n  }\n\n  handleClearInputBtn() {\n    this.dom.$searchInput.focus();\n    this.dom.$searchInput.value = '';\n    this.dom.$searchField.setAttribute('aria-expanded', false);\n    this.dom.$clearInputBtn.hidden = true;\n  }\n\n  async handleSearchInputChange(e) {\n    var _this$dom$$viewAll$da;\n\n    const {\n      value\n    } = e.target;\n    const [key, val] = ((_this$dom$$viewAll$da = this.dom.$viewAll.dataset.additionalQueryString) === null || _this$dom$$viewAll$da === void 0 ? void 0 : _this$dom$$viewAll$da.split('=')) || [null, null];\n\n    if (value) {\n      var _response$Results;\n\n      this.dom.$clearInputBtn.hidden = false;\n      const response = await fetch(Object(query_string__WEBPACK_IMPORTED_MODULE_3__[\"stringifyUrl\"])({\n        url: this.endpoint,\n        query: {\n          query: value\n        }\n      })).then(blob => blob.json());\n\n      if (response !== null && response !== void 0 && (_response$Results = response.Results) !== null && _response$Results !== void 0 && _response$Results.length) {\n        const resultsListHtml = response.Results.map(searchSuggestion).join('');\n        this.dom.$resultsList.hidden = false;\n        this.dom.$resultsList.setAttribute('role', 'listbox');\n        this.dom.$resultsList.innerHTML = resultsListHtml;\n        this.dom.$searchField.setAttribute('aria-expanded', true);\n        this.dom.$searchAnnounce.textContent = `${Object(number_to_text__WEBPACK_IMPORTED_MODULE_4__[\"convertToText\"])(response.Results.length)} suggestion${response.Results.length > 1 ? 's' : ''} found, to navigate use up and down`;\n        this.dom.$searchField.dataset.hasResults = true;\n        this.dom.$viewAll.href = Object(query_string__WEBPACK_IMPORTED_MODULE_3__[\"stringifyUrl\"])({\n          url: this.searchPageUrl,\n          query: {\n            keyword: value,\n            ...(key && {\n              [key]: val\n            })\n          }\n        });\n      } else if (response !== null && response !== void 0 && response.DidYouMean) {\n        var _response$DidYouMean, _response$DidYouMean2, _response$DidYouMean3;\n\n        this.dom.$resultsList.hidden = false;\n        this.dom.$resultsList.removeAttribute('role');\n        this.dom.$resultsList.innerHTML = searchSuggestionDidYouMean(response === null || response === void 0 ? void 0 : (_response$DidYouMean = response.DidYouMean) === null || _response$DidYouMean === void 0 ? void 0 : _response$DidYouMean.Label, response === null || response === void 0 ? void 0 : (_response$DidYouMean2 = response.DidYouMean) === null || _response$DidYouMean2 === void 0 ? void 0 : _response$DidYouMean2.Value, Object(query_string__WEBPACK_IMPORTED_MODULE_3__[\"stringifyUrl\"])({\n          url: this.searchPageUrl,\n          query: {\n            keyword: (_response$DidYouMean3 = response.DidYouMean) === null || _response$DidYouMean3 === void 0 ? void 0 : _response$DidYouMean3.Value,\n            ...(key && {\n              [key]: val\n            })\n          }\n        }), 0);\n        this.dom.$searchField.dataset.hasResults = false;\n        this.dom.$resultsList.removeAttribute('role');\n        this.dom.$searchField.setAttribute('aria-expanded', true);\n        this.dom.$searchAnnounce.textContent = '';\n        this.dom.$viewAll.href = Object(query_string__WEBPACK_IMPORTED_MODULE_3__[\"stringifyUrl\"])({\n          url: this.searchPageUrl,\n          query: {\n            keyword: value,\n            ...(key && {\n              [key]: val\n            })\n          }\n        });\n      }\n    } else {\n      this.dom.$clearInputBtn.hidden = true;\n      this.dom.$resultsList.hidden = true;\n      this.dom.$resultsList.innerHTML = '';\n      this.dom.$searchField.dataset.hasResults = false;\n      this.dom.$searchField.setAttribute('aria-expanded', false);\n    }\n  }\n\n  handleListFocus(e) {\n    const suggestions = this.el.querySelectorAll('.header__search-item:not(.header__search-item--did-you-mean)');\n    const item = e.target.closest('.header__search-item:not(.header__search-item--did-you-mean)');\n    suggestions.forEach(suggestion => suggestion.setAttribute('aria-selected', false));\n\n    if (item) {\n      item.setAttribute('aria-selected', true);\n      this.dom.$searchInput.setAttribute('aria-activedescendant', item.id);\n    } else {\n      this.dom.$searchInput.removeAttribute('aria-activedescendant');\n    }\n  }\n\n  handleSearchFieldKeyup(e) {\n    const links = this.dom.$resultsList.querySelectorAll('a');\n\n    if (document.activeElement === this.dom.$searchInput && e.keyCode === DOWN && links) {\n      links[0].focus();\n    }\n  }\n\n  handleResize() {\n    this.searchInputWidth();\n  }\n\n  handleScroll() {\n    const st = window.pageYOffset || document.documentElement.scrollTop;\n\n    if (window.pageYOffset > 100) {\n      if (st > this.lastScrollTop) {\n        if (!this.el.classList.contains('header--scroll-down')) {\n          this.el.classList.add('header--scroll-down');\n        }\n      } else {\n        if (this.el.classList.contains('header--scroll-down')) {\n          this.el.classList.remove('header--scroll-down');\n        }\n      }\n\n      this.lastScrollTop = st <= 0 ? 0 : st;\n    } else {\n      this.el.classList.remove('header--scroll-down');\n    }\n  }\n\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Header);\n\n//# sourceURL=webpack:///./src/components/header/header.js?");

/***/ })

}]);